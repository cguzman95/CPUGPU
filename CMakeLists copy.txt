cmake_minimum_required(VERSION 3.10)
project(main)

find_package(MPI)
enable_language(CUDA)
find_package(MPI REQUIRED)
set(STD_CUDA_FLAGS "-g -O3 --default-stream per-thread -lnvToolsExt")
set(SRC main.cu)
set_source_files_properties(${SRC} PROPERTIES LANGUAGE CUDA)
set_source_files_properties(${SRC} PROPERTIES CUDA_SOURCE_PROPERTY_FORMAT OBJ)
set_source_files_properties(${SRC} PROPERTIES COMPILE_FLAGS ${STD_CUDA_FLAGS})
set_source_files_properties(${SRC} PROPERTIES CUDA_ARCHITECTURES "70")
add_executable(main ${SRC})
find_library(LIBNVTOOLSEXT nvToolsExt PATHS ${CMAKE_CUDA_IMPLICIT_LINK_DIRECTORIES})
target_link_libraries(main ${LIBNVTOOLSEXT})
target_link_libraries(main ${CUDA_LIBRARIES})
target_link_libraries(main m)
